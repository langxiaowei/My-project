# 物联网设备数据监控与告警平台（IoT Platform）

## 一、项目简介

本项目是一个 **面向物联网场景的设备数据监控与告警平台**，基于 **Spring Cloud 微服务架构** 实现设备数据的高并发采集、在线状态管理、历史数据存储与异常告警处理。

系统将设备抽象为 **周期性上报数据的客户端**，通过 **HTTP + 消息队列（RabbitMQ）** 实现数据接入与业务解耦，支持设备在线判定、指标趋势分析、异常阈值告警，适用于 **工业设备监控、环境监测、设备状态采集等场景**。

---

## 二、技术架构

### 技术选型

- 后端框架：Spring Boot / Spring Cloud Gateway
- 服务治理：Nacos
- 消息中间件：RabbitMQ
- 缓存组件：Redis
- 数据持久化：MyBatis + MySQL
- 认证鉴权：JWT
- 定时任务：XXL-Job
- 服务通信：OpenFeign
- 构建工具：Maven

### 系统架构示意

设备端
↓ HTTP
Gateway（统一鉴权）
↓
业务微服务
↓
RabbitMQ（异步解耦）
↓
Consumer / 告警处理 / 通知服务

yaml
复制代码

---

## 三、核心功能设计

### 1. 设备数据上报与异步解耦

- 设计 **HTTP → RabbitMQ → Consumer** 的设备数据上报链路
- 通过消息队列解耦数据接入与业务处理，提高系统抗峰值能力
- 使用 **RabbitMQ Producer / Consumer + 手动 ACK 机制**
- 引入 **死信队列（DLQ）** 处理异常消息，避免数据丢失

---

### 2. 设备上报限流与数据去重

- 基于 **Redis** 实现设备 **1 秒级上报频率控制**
- 防止设备异常频繁上报导致数据重复写入
- 在消费者侧结合 **消息唯一 ID（msgId）+ Redis 去重**
- 解决 MQ 重投、重复消费导致的数据一致性问题

---

### 3. 设备在线状态与心跳管理

- 使用 **Redis Key TTL + 心跳刷新** 实现设备在线状态管理
- 设备定期上报自动刷新 TTL
- 结合 **XXL-Job 定时任务** 扫描超时设备，批量标记为离线
- 减少数据库频繁读写压力

---

### 4. 告警检测与告警去重

- 基于设备上报数据实现 **阈值告警逻辑**
- 支持多指标扩展（温度、湿度、电量等）
- 使用 Redis 实现：
  - 告警去重
  - 短时间内重复告警抑制
- 避免“告警风暴”问题

---

### 5. 告警事件异步通知与解耦

- 告警产生与通知处理完全解耦
- 基于 RabbitMQ 设计独立的 **notification-service**
- 支持告警消息可靠投递（手动 ACK + DLQ）
- 消费端落库记录通知事件，形成 **“告警 → 通知 → 可追溯”闭环**
- 为后续 **短信 / 邮件 / Webhook** 等多渠道通知预留扩展空间

---

### 6. 微服务治理与接口安全

- 使用 **Spring Cloud Gateway + JWT** 实现统一鉴权
- 网关层隔离内部微服务，避免服务直连
- 使用 **Feign** 完成服务间通信，职责清晰

---

### 7. 数据存储与历史查询

- 使用 **MyBatis + MySQL** 存储设备历史数据
- 支持按设备维度查询历史数据
- 支持基础统计分析能力

---

### 8. 稳定性与可维护性设计

- 编写设备状态检测、历史数据清理等定时任务
- 提升系统长期运行稳定性
- 使用 **Postman + 接口文档** 对服务进行独立验证
- 支持服务独立部署与测试

---

## 四、项目结构说明

iot-platform
├── iot-gateway # 网关服务
├── iot-data # 设备数据服务
├── iot-device # 设备管理服务
├── iot-user # 用户与鉴权服务
├── notification-service # 告警通知服务
├── pom.xml # 父工程 POM

yaml
复制代码

---

## 五、运行环境

- JDK 8+
- MySQL 8.x
- Redis
- RabbitMQ
- Nacos
- XXL-Job

---

## 六、说明

本项目为个人学习与实践项目，重点在于 **分布式系统设计、异步解耦、消息可靠性与系统稳定性** 的综合实践。
